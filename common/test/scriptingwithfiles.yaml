vars:
  rampTime: 1m
  loadTime: 1m
  logDir: ${e:SPLUNK_PATH}
load_pattern:
  - !linear
      from: 1%
      to: 100%
      over: ${v:rampTime}
  - !linear
      from: 100%
      to: 100%
      over: ${v:loadTime}
config:
  client:
    # request_timeout: { secs: 10, nanos: 0 }
    # request_timeout: 10s
    headers:
      TestTime: ${x:epoch("ms")}
      Accept: application/json
      FS-User-Agent-Chain: PPAAS-Agent-Performance Test
      User-Agent: FS-QA-SystemTest PPAAS Agent Performance Test
  general:
    bucket_size: 1m
    log_provider_stats: true
loggers:
  remote_logger:
    query:
      select:
        timestamp: epoch("ms")
        request: request["start-line"]
        method: request.method
        url: request.url
        response: response["start-line"]
        status: response.status
      where: response.status >= 400
    limit: 1000
    to: !file '${v:logDir}/http-err-${x:epoch("ms")}.json'
    pretty: false
  local_logger:
    query:
      select: '`${request["start-line"]},${response["start-line"]},${request.method},${response.status}`'
      where: response.status >= 400
    limit: 1000
    to: !file 'errors.csv'
    pretty: false
providers:
  sessionId: !response
    # buffer: 100
    auto_return: force
  file: !file
    path: 's3test.txt'
    repeat: true
    format: line
    random: true
endpoints:
  - method: GET
    url: http://127.0.0.1:8080/healthcheck
    peak_load: 30hpm
